<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description"
        content="DyMO: Training-Free Diffusion Model Alignment with Dynamic Multi-Objective Scheduling">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HyperAlign: Hypernetwork for Efficient Test-Time Alignment of Diffusion Models</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-PYVRSFMDRL');
    </script>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">
    <link rel="icon" href="./static/img/COLE.jpg">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>

<body>

    <style>
        .publication-title {
            font-family: "textsc "
        }

        video {
            outline: none;
            border: none;
            box-shadow: none;
        }

        .image_wrapper {
            position: relative;
            width: 226px;
            height: 226px;
        }

        .image_container {
            border-radius: 10px;
            /*ËÆæÁΩÆÂõæÁâáÁöÑÂúÜËßíÔºåÂèØ‰ª•Ê†πÊçÆ‰Ω†ÁöÑÈúÄÊ±ÇË∞ÉÊï¥Ëøô‰∏™ÂÄº*/
            /*margin: 10px; !* Âú®ÂõæÁâáÁöÑÂ§ñÈÉ®ÂÖÉÁ¥†‰∏äËÆæÁΩÆÈó¥Ë∑ù *!*/
            overflow: hidden;
            /* ‰∏∫‰∫Ü‰øùÊåÅÂõæÁâáÁöÑÂúÜËßíÊïàÊûú */
            position: relative;
            width: 100%;
            padding-bottom: 100%;
        }

        .image_container img {

            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* Ëøô‰ºö‰ΩøÂõæÁâá‰øùÊåÅÂéüÂßãÊØî‰æãÔºå‰ΩÜ‰ªçÁÑ∂Â°´ÂÖÖÂÖ∂ÂÆπÂô® */
            object-position: center;
            /* Êñ∞Â¢ûÂä†ÁöÑ‰ª£Á†ÅÔºåËÆ©ÂõæÁâáÂ±Ö‰∏≠ */
        }

        .caption {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            display: flex;
            align-items: center;
            /* ÂûÇÁõ¥Â±Ö‰∏≠ */
            justify-content: center;
            /* Ê∞¥Âπ≥Â±Ö‰∏≠ */
            font-family: 'Comic Sans MS', 'Verdana', 'Tahoma', sans-serif;
            text-align: center;
            /* ËÆ©ÊñáÊú¨Âú®ÂÖ∂ÂÆπÂô®‰∏≠Ê∞¥Âπ≥Â±Ö‰∏≠ */
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .image_container:hover .caption {
            opacity: 1;
        }



        .column.is-2.has-text-centered img.interpolation-image {

            object-fit: cover;
            border-radius: 10px;
            transition: opacity 0.5s ease;
            object-position: center;
            /* Êñ∞Â¢ûÂä†ÁöÑ‰ª£Á†ÅÔºåËÆ©ÂõæÁâáÂ±Ö‰∏≠ */
        }

        .column.is-2.has-text-centered:hover img.interpolation-image {
            opacity: 0.5;
        }

        .column.is-2.has-text-centered .caption {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            display: flex;
            align-items: center;
            /* ÂûÇÁõ¥Â±Ö‰∏≠ */
            justify-content: center;
            /* Ê∞¥Âπ≥Â±Ö‰∏≠ */
            font-family: 'Comic Sans MS', 'Verdana', 'Tahoma', sans-serif;
            text-align: center;
            /* ËÆ©ÊñáÊú¨Âú®ÂÖ∂ÂÆπÂô®‰∏≠Ê∞¥Âπ≥Â±Ö‰∏≠ */
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .column.is-2.has-text-centered:hover .caption {
            opacity: 1;
        }

        .columns.is-centered img {
            margin-bottom: 1px;
            margin-top: 30px;
            /* ÊàñËÄÖ‰Ω†ÊÉ≥Ë¶ÅÁöÑ‰ªª‰ΩïÂÄº */
        }


        .section {
            margin: 3px;
            padding: 5px;
        }

        .table-container {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        table {
            border-collapse: collapse;
            width: 48%;
            margin: 1%;
            float: left;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }

        caption {
            caption-side: bottom;
            font-size: medium;
        }

        .highlight {
            background-color: #e6f7ff;
        }

        .underline {
            text-decoration: underline;
        }

        
    </style>

    <!--<h1 class="title is-1 publication-title">COLE :A Hierarchical Generation Framework for Graphic Design</h1>-->


    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-desktop">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <h1 class="title is-1 ">HyperAlign: Hypernetwork for Efficient Test-Time Alignment of Diffusion Models</h1>
                        <div class="is-size-5 publication-authors">
                            <span class="author-block">
                                <a href="https://shelsin.github.io/">Xin Xie</a>&nbsp&nbsp&nbsp
                            </span>
                            <span class="author-block">
                                <a href="https://cr-gjx.github.io/">Jiaxian Guo</a>&nbsp&nbsp&nbsp
                            </span>
                            <span class="author-block">
                                <a href="https://donggong1.github.io/">Dong Gong</a><sup></sup>
                            </span>
                            <!-- <br>
            <span class="is-size-6 publication-authors">
              <sup>1</sup><span>interns at microsoft&nbsp&nbsp&nbsp</span>
            </span>
            <span class="is-size-6 publication-authors">
              <sup>2</sup><span>core contribution&nbsp&nbsp&nbsp</span>
            </span>
            <span class="is-size-6 publication-authors">
              <sup>3</sup><span>project lead&nbsp&nbsp&nbsp</span>
            </span> -->
                        </div>

                        <div class="is-size-5 publication-authors">
                            <span class="author-block"><sup> </sup>University of New South Wales (UNSW Sydney), Google Research</span>
                        </div>

                        <div class="column has-text-centered">
                            <div class="publication-links">
                                <span class="link-block">
                                    <!-- TODO: add arxiv link -->
                                    <a href="https://arxiv.org/abs/2601.15968" class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="ai ai-arxiv"></i>
                                        </span>
                                        <span>arXiv</span>
                                    </a>
                                </span>
                                <span class="link-block">
                                    <a href="https://github.com/Shelsin/HyperAlign"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-github"></i>
                                        </span>
                                        <span>Code (Coming soon)</span>
                                    </a>
                                </span>
                                <span class="link-block">
                                  <a href="https://www.youtube.com/watch?xxx"
                                      class="external-link button is-normal is-rounded is-dark">
                                      <span class="icon">
                                        üòä
                                      </span>
                                      <span>YouTube (Coming soon)</span>
                                  </a>
                              </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </section>

    <br>
    <br>

    <section class="section">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <div class="column is-four-fifths">
                    <h2 class="title is-3">Abstract</h2>
                    <div class="content has-text-justified">
                        <p>  
                            Diffusion models achieve state-of-the-art performance but often fail to generate outputs that align with human preferences and intentions, resulting in images with poor aesthetic quality and semantic inconsistencies. Existing alignment methods present a difficult trade-off: fine-tuning approaches suffer from loss of diversity with reward over-optimization, while test-time scaling methods introduce significant computational overhead and tend to under-optimize.
                        </p>
                        <p>
                            To address these limitations, we propose HyperAlign, a novel framework that trains a hypernetwork for efficient and effective test-time alignment. Instead of modifying latent states, HyperAlign dynamically generates low-rank adaptation weights to modulate the diffusion model's generation operators. This allows the denoising trajectory to be adaptively adjusted based on input latents, timesteps and prompts for reward-conditioned alignment. We introduce multiple variants of HyperAlign that differ in how frequently the hypernetwork is applied, balancing between performance and efficiency. Furthermore, we optimize the hypernetwork using a reward score objective regularized with preference data to reduce reward hacking.
                        </p>
                        <p>
                            We evaluate HyperAlign on multiple extended generative paradigms, including Stable Diffusion and FLUX. It significantly outperforms existing fine-tuning and test-time scaling baselines in enhancing semantic consistency and visual appeal.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <br>
    <br>

    <!--
    <div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
        <h2 class="title is-3">Quantitative Results</h2>
        <div class="table-container">
            <table>
                <caption>Comparison of AI feedback on SD V1.5-based methods.</caption>
                <thead>
                    <tr>
                        <th>Methods</th>
                        <th>PickScore</th>
                        <th>HPSv2</th>
                        <th>ImageReward</th>
                        <th>Aesthetics</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SD V1.5</td>
                        <td>20.73</td>
                        <td>0.2341</td>
                        <td>0.1697</td>
                        <td>5.337</td>
                    </tr>
                    <tr>
                        <td>DNO</td>
                        <td>20.05</td>
                        <td>0.2591</td>
                        <td>-0.3212</td>
                        <td>5.597</td>
                    </tr>
                    <tr>
                        <td>PromptOpt</td>
                        <td>20.26</td>
                        <td>0.2490</td>
                        <td>-0.3366</td>
                        <td>5.465</td>
                    </tr>
                    <tr>
                        <td>FreeDom</td>
                        <td>21.96</td>
                        <td>0.2605</td>
                        <td>0.3963</td>
                        <td>5.515</td>
                    </tr>
                    <tr>
                        <td>AlignProp</td>
                        <td>20.56</td>
                        <td>0.2627</td>
                        <td>0.1128</td>
                        <td>5.456</td>
                    </tr>
                    <tr>
                        <td>Diffusion-DPO</td>
                        <td>20.97</td>
                        <td>0.2656</td>
                        <td>0.2989</td>
                        <td>5.594</td>
                    </tr>
                    <tr>
                        <td>Diffusion-KTO</td>
                        <td>21.15</td>
                        <td>0.2719</td>
                        <td>0.6156</td>
                        <td>5.697</td>
                    </tr>
                    <tr>
                        <td>SPO</td>
                        <td>21.46</td>
                        <td>0.2671</td>
                        <td>0.2321</td>
                        <td>5.702</td>
                    </tr>
                    <tr class="highlight">
                        <td>SD V1.5+Ours</td>
                        <td><b>23.07</b></td>
                        <td><b>0.2755</b></td>
                        <td><b>0.7170</b></td>
                        <td><b>5.831</b></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="table-container">
            <table>
                <caption>Comparison of AI feedback on SDXL-based methods.</caption>
                <thead>
                    <tr>
                        <th>Methods</th>
                        <th>PickScore</th>
                        <th>HPSv2</th>
                        <th>ImageReward</th>
                        <th>Aesthetics</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SDXL</td>
                        <td>21.91</td>
                        <td>0.2602</td>
                        <td>0.7755</td>
                        <td>5.960</td>
                    </tr>
                    <tr>
                        <td>DNO</td>
                        <td>22.14</td>
                        <td>0.2725</td>
                        <td>0.9053</td>
                        <td>6.042</td>
                    </tr>
                    <tr>
                        <td>PromptOpt</td>
                        <td>21.98</td>
                        <td>0.2708</td>
                        <td>0.8671</td>
                        <td>5.881</td>
                    </tr>
                    <tr>
                        <td>FreeDom</td>
                        <td>22.13</td>
                        <td>0.2719</td>
                        <td>0.7722</td>
                        <td>5.908</td>
                    </tr>
                    <tr class="highlight">
                        <td>SDXL+Ours</td>
                        <td><b>24.90</b></td>
                        <td><b>0.2839</b></td>
                        <td><b>1.074</b></td>
                        <td><b>6.138</b></td>
                    </tr>
                    <tr>
                        <td>Diffusion-DPO</td>
                        <td>22.30</td>
                        <td>0.2741</td>
                        <td>0.9789</td>
                        <td>5.891</td>
                    </tr>
                    <tr class="highlight">
                        <td>Diff-DPO+Ours</td>
                        <td><b>24.46</b></td>
                        <td><b>0.2836</b></td>
                        <td><b>1.049</b></td>
                        <td><b>6.116</b></td>
                    </tr>
                    <tr>
                        <td>SPO</td>
                        <td>22.81</td>
                        <td>0.2778</td>
                        <td>1.082</td>
                        <td><b>6.319</b></td>
                    </tr>
                    <tr class="highlight">
                        <td>SPO+Ours</td>
                        <td><b>23.85</b></td>
                        <td><b>0.2821</b></td>
                        <td><b>1.166</b></td>
                        <td><b>6.278</b></td>
                    </tr>
                    <tr>
                        <td>SD V3.5</td>
                        <td>21.93</td>
                        <td>0.2726</td>
                        <td>0.9697</td>
                        <td>5.775</td>
                    </tr>
                    <tr>
                        <td>FLUX</td>
                        <td>22.04</td>
                        <td>0.2760</td>
                        <td>1.011</td>
                        <td>6.077</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
    </div>
</div>
    
<br>
<br>
    
<div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
        <h2 class="title is-3">User Study Results</h2>
        <img src="./static/assets/results/user_study_compare_hps.png" alt="pipeline" style="width: 80%;">
        <br>
                <caption>User preference distribution on HPSv2 benchmark.</caption>
        <br>
        <img src="./static/assets/results/user_study_with_and_without.png" alt="pipeline" style="width: 80%;">
        <br>
                <caption>Human evaluation with and without our method on PartiPrompts and HPSv2 datasets.</caption>
        <br>
    </div>
</div>
    
<br>
<br>

<div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
        <h2 class="title is-3">Qualitative Results</h2>
        <img src="./static/assets/results/sd15compare.png" alt="pipeline" style="width: 80%;">
        <br>
        <div class="content has-text-justified">
                <caption>Qualitative comparison based on SD V1.5 backbones. The text prompts used to generate the images from top to bottom are: (1) A photo of a frog holding an apple while smiling in the forest. (2) little tiny cub beautiful light color White fox soft fur kawaii chibi Walt Disney style, beautiful smiley face and beautiful eyes sweet and smiling features, snuggled in its soft and soft pastel pink cover, magical light background, style Thomas kinkade Nadja Baxter Anne Stokes Nancy Noel realistic. (3) On the Mid-Autumn Festival, the bright full moon hangs in the night sky. A quaint pavilion is illuminated by dim lights, resembling a beautiful scenery in a painting. Camera type: close-up. Camera lens type: telephoto. Time of day: night. Style of lighting: bright. Film type: ancient style. HD. (4) a gopro snapshot of an anthropomorphic cat dressed as a firefighter putting out a building fire. (5) A rock formation in the shape of a horse, insanely detailed. (6) A 3D Rendering of a cockatoo wearing sunglasses. The sunglasses have a deep black frame with bright pink lenses. Fashion photography, volumetric lighting, CG rendering. (7) A swirling, multicolored portal emerges from the depths of an ocean of coffee, with waves of the rich liquid gently rippling outward. The portal engulfs a coffee cup, which serves as a gateway to a fantastical dimension. The surrounding digital art landscape reflects the colors of the portal, creating an alluring scene of endless possibilities.</caption>
        </div>
        <br>
        <img src="./static/assets/results/sdXLcompare.png" alt="pipeline" style="width: 80%;">
        <br>
        <div class="content has-text-justified">
                <caption>Qualitative comparison based on SDXL backbones. The text prompts used to generate the images from top to bottom are: (1) A smiling beautiful sorceress wearing a high necked blue suit surrounded by swirling rainbow aurora, hyper-realistic, cinematic, post-production. (2) a golden retriever dressed like a General in the north army of the American Civil war. Portrait style, looking proud detailed 8k realistic super realistic Ultra HD cinematography photorealistic epic composition Unreal Engine Cinematic Color Grading portrait Photography UltraWide Angle Depth of Field hyperdetailed beautifully colorcoded insane details intricate details beautifully color graded Unreal Engine Editorial Photography Photography Photoshoot DOF Tilt Blur White Balance 32k SuperResolution Megapixel ProPhoto RGB VR Halfrear Lighting Backlight Natural Lighting Incandescent Optical Fiber Moody Lighting Cinematic Lighting Studio Lighting Soft Lighting Volumetric ContreJour Beautiful Lighting Accent Lighting Global Illumination Screen Space Global Illumination Ray Tracing Optics Scattering Glowing Shadows Rough Shimmering Ray Tracing Reflections Lumen Reflections Screen Space Reflections Diffraction Grading Chromatic Aberration GB Displacement Scan Lines Ray Traced Ray Tracing Ambient Occlusion AntiAliasing FKAA TXAA RTX SSAO Shaders. (3) A profile picture of an anime boy, half robot, brown hair. (4) Full body, a Super cute little girl, wearing cute little giraffe pajamas, Smile and look ahead, ultra detailed sky blue eyes, 8k bright front lighting, fine luster, ultra detail, hyper detailed 3D rendering s750. (5) little tiny cub beautiful light color White fox soft fur kawaii chibi Walt Disney style, beautiful smiley face and beautiful eyes sweet and smiling features, snuggled in its soft and soft pastel pink cover, magical light background, style Thomas kinkade Nadja Baxter Anne Stokes Nancy Noel realistic. (6) A swirling, multicolored portal emerges from the depths of an ocean of coffee, with waves of the rich liquid gently rippling outward. The portal engulfs a coffee cup, which serves as a gateway to a fantastical dimension. The surrounding digital art landscape reflects the colors of the portal, creating an alluring scene of endless possibilities. (7) a white polar bear cub wearing sunglasses sits in a meadow with flowers. </caption>
        </div>
        <br>
    </div>
</div>

<br>
<br>

<div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
        <h2 class="title is-3">More Visual Results</h2>
        <p>
             The entire denoising process of SD V1.5 and DyMO, including the noisy images and one-step predicted clean images at step <em>t</em>, respectively.
        </p>
        <img src="./static/assets/results/process_frog.png" alt="pipeline" style="width: 80%;">
        <br>
                <caption>A photo of a frog holding an apple while smiling in the forest.</caption>
        <br>
        <img src="./static/assets/results/process_polar.png" alt="pipeline" style="width: 80%;">
        <br>
                <caption>a white polar bear cub wearing sunglasses sits in a meadow with flowers.</caption>
        <br>
    </div>
</div>
 -->
    
<br>
<br>

    <section class="section" id="BibTeX">
        <div class="container is-max-desktop content">
            <h2 class="title">BibTeX</h2>
            <pre><code>
@article{xin2025hyperalign,
  title={HyperAlign: Hypernetwork for Efficient Test-Time Alignment of Diffusion Models},
  author={Xie, Xin and Guo, Jiaxian and Gong, Dong},
  journal={arXiv preprint arXiv:2601.xxxxx},
  year={2024}
}
            </code></pre>
        </div>
    </section>

<br>
<br>
    
    <section class="section" id="Acknowledgements">
        <div class="container is-max-desktop content">
            <h2 class="title">Acknowledgements</h2>
            Website adapted from the following <a href="https://nerfies.github.io/">template</a>.
        </div>
    </section>

</body>

</html>
